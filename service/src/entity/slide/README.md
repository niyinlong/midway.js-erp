# 幻灯片模块 (Slide) 产品文档

## 模块概述

幻灯片模块（Slide）是一个功能强大的教育培训内容管理系统，提供了完整的在线学习平台功能。该模块允许用户创建、组织、分享和跟踪各种类型的学习内容，包括文档、视频、信息图表、文章和测验等。系统支持将内容组织成结构化的课程（频道），并提供用户参与跟踪、进度监控和互动功能。

### 主要功能亮点：
- 多类型内容管理（文档、视频、图表、文章、测验）
- 课程/学习路径组织
- 用户进度跟踪和完成情况统计
- 互动测验和评分系统
- 内容分享和嵌入第三方网站
- 用户参与度分析（浏览量、点赞、投票）
- 课程邀请和成员管理
- SEO优化支持
- 多语言内容支持

## 实体表结构与功能详解

### 1. 核心内容管理

#### 1.1 幻灯片/内容 (slide_slide)

**功能**：存储各种类型的学习内容，是系统的核心实体。

**主要字段**：
- `id`：主键ID
- `channel_id`：所属频道/课程ID
- `category_id`：内容分类ID
- `slide_type`：内容类型（文档、视频、信息图表、文章、测验）
- `name`：内容标题（JSON格式，支持多语言）
- `description`：内容描述（JSON格式，支持多语言）
- `html_content`：HTML内容（JSON格式）
- `is_published`：是否发布
- `active`：是否激活
- `is_preview`：是否允许预览
- `slide_resource_downloadable`：是否允许下载资源
- `completion_time`：预计完成时间（分钟）
- `likes/dislikes`：点赞/点踩数量
- `slide_views/public_views/total_views`：浏览统计
- `quiz_first_attempt_reward`等：测验奖励设置

#### 1.2 幻灯片资源 (slide_slide_resource)

**功能**：存储与幻灯片内容相关的附加资源文件。

**主要字段**：
- `id`：主键ID
- `slide_id`：关联的幻灯片ID
- `resource_type`：资源类型
- `name`：资源名称
- `file_name`：文件名
- `link`：资源链接

### 2. 课程/频道管理

#### 2.1 频道/课程 (slide_channel)

**功能**：将幻灯片内容组织成结构化的课程或学习路径。

**主要字段**：
- `id`：主键ID
- `website_id`：关联网站ID
- `channel_type`：课程类型
- `visibility`：可见性设置
- `enroll`：注册策略
- `total_slides`：总内容数量
- `total_views`：总浏览量
- `promote_strategy`：特色内容策略
- `karma_gen_channel_rank`等：积分设置
- `publish_template_id`等：通知模板设置

#### 2.2 频道参与者 (slide_channel_partner)

**功能**：跟踪用户在课程中的参与状态和进度。

**主要字段**：
- `id`：主键ID
- `channel_id`：频道ID
- `partner_id`：参与者ID
- `member_status`：成员状态
- `completion`：完成百分比
- `completed_slides_count`：已完成内容数量
- `active`：是否活跃

### 3. 互动功能

#### 3.1 问题 (slide_question)

**功能**：存储测验问题。

**主要字段**：
- `id`：主键ID
- `slide_id`：所属幻灯片ID
- `question`：问题内容（JSON格式，支持多语言）
- `sequence`：显示顺序

#### 3.2 答案 (slide_answer)

**功能**：存储问题的可能答案。

**主要字段**：
- `id`：主键ID
- `question_id`：关联的问题ID
- `text_value`：答案文本（JSON格式，支持多语言）
- `is_correct`：是否为正确答案
- `comment`：答案注释（JSON格式）

#### 3.3 幻灯片参与者 (slide_slide_partner)

**功能**：跟踪用户与单个幻灯片内容的交互。

**主要字段**：
- `id`：主键ID
- `slide_id`：幻灯片ID
- `channel_id`：频道ID
- `partner_id`：参与者ID
- `completed`：是否完成
- `vote`：投票值
- `quiz_attempts_count`：测验尝试次数

### 4. 嵌入与分享

#### 4.1 嵌入统计 (slide_embed)

**功能**：跟踪幻灯片在第三方网站上的嵌入和查看情况。

**主要字段**：
- `id`：主键ID
- `slide_id`：幻灯片ID
- `url`：第三方网站URL
- `count_views`：查看次数

### 5. 标签与分类

#### 5.1 幻灯片标签 (slide_tag)

**功能**：存储幻灯片内容的标签。

**主要字段**：
- `id`：主键ID
- `name`：标签名称（JSON格式，支持多语言）

#### 5.2 频道标签 (slide_channel_tag)

**功能**：存储课程/频道的标签。

**主要字段**：
- `id`：主键ID
- `group_id`：标签组ID
- `name`：标签名称（JSON格式，支持多语言）
- `color`：标签颜色索引

#### 5.3 频道标签组 (slide_channel_tag_group)

**功能**：组织和分类频道标签。

**主要字段**：
- `id`：主键ID
- `name`：组名称（JSON格式，支持多语言）
- `sequence`：显示顺序
- `is_published`：是否发布

#### 5.4 频道标签关系 (slide_channel_tag_rel)

**功能**：建立频道与标签之间的多对多关系。

**主要字段**：
- `channel_id`：频道ID
- `tag_id`：标签ID

### 6. 邀请与先决条件

#### 6.1 频道邀请 (slide_channel_invite)

**功能**：管理课程邀请流程。

**主要字段**：
- `id`：主键ID
- `channel_id`：频道ID
- `template_id`：邮件模板ID
- `subject`：邀请主题
- `body`：邀请内容
- `send_email`：是否发送邮件
- `enroll_mode`：是否自动注册

#### 6.2 频道先决条件关系 (slide_channel_prerequisite_slide_channel_rel)

**功能**：设置课程之间的依赖关系。

**主要字段**：
- `channel_id`：频道ID
- `prerequisite_channel_id`：先决条件频道ID

## 实体关系图

```
mermaid
flowchart TD
    subgraph 内容管理
        A[幻灯片/内容] --> B[幻灯片资源]
        A --> C[嵌入统计]
    end
    
    subgraph 课程管理
        D[频道/课程] --> A
        D --> E[频道参与者]
        D --> F[频道标签关系]
        D --> G[频道邀请]
        D --> H[频道先决条件关系]
    end
    
    subgraph 互动功能
        A --> I[问题]
        I --> J[答案]
        A --> K[幻灯片参与者]
        E --> K
    end
    
    subgraph 标签系统
        F --> L[频道标签]
        L --> M[频道标签组]
        A --> N[幻灯片标签]
    end
    
    H --> D
```

## 主要业务流程

### 1. 内容创建与发布流程
1. 创建幻灯片内容（设置类型、标题、描述、HTML内容等）
2. 添加相关资源（文档、视频等）
3. 将内容添加到相应频道/课程
4. 设置内容可见性和访问权限
5. 发布内容并监控访问统计

### 2. 课程学习流程
1. 用户被邀请或自行注册课程
2. 系统记录用户为频道参与者
3. 用户浏览和学习课程内容
4. 系统更新用户进度和完成状态
5. 用户参与测验并获得反馈
6. 完成课程后获得积分奖励

### 3. 互动测验流程
1. 内容创建者添加问题和答案（设置正确答案）
2. 学习者查看内容并回答问题
3. 系统记录尝试次数和完成状态
4. 根据回答正确情况发放奖励积分

## 特色功能

### 1. 多类型内容支持
系统支持多种内容类型，包括文档、视频、信息图表、文章和互动测验，满足不同的教学需求。

### 2. 详细的进度跟踪
通过频道参与者和幻灯片参与者实体，系统可以精确跟踪每个用户在每个课程和每个内容上的学习进度。

### 3. 积分奖励系统
为鼓励学习参与，系统提供了完善的积分奖励机制，对测验、评论、投票等行为进行奖励。

### 4. 内容嵌入与分享
支持将内容嵌入到第三方网站，并提供嵌入统计功能，扩展内容的影响力。

### 5. 课程依赖管理
通过频道先决条件功能，可以设置课程之间的学习顺序，确保学习者按照合理的路径学习。

### 6. 多语言支持
大多数内容字段使用JSON格式存储，支持多语言版本，满足国际化需求。

### 7. SEO优化
提供完整的SEO元数据支持，包括标题、描述、关键词等，提高内容在搜索引擎中的可见度。

## 技术实现要点

1. **多语言支持**：使用JSONB类型存储多语言内容，便于国际化
2. **内容类型系统**：通过slide_type字段区分不同类型的内容，实现统一管理
3. **关系映射**：使用TypeORM的关系装饰器定义实体间关系，支持复杂查询
4. **统计跟踪**：内置多种统计字段，自动跟踪内容访问和用户参与情况
5. **权限控制**：通过visibility和enroll字段实现灵活的内容访问控制

## 总结

幻灯片模块（Slide）是一个功能全面的教育培训内容管理系统，提供了从内容创建、组织、分享到学习跟踪的完整解决方案。该模块的核心价值在于其灵活性和可扩展性，能够支持各种类型的教育培训需求，同时提供详细的数据分析和用户互动功能，帮助教育者和学习者实现更好的教学效果和学习体验。